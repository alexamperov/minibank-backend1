# Документация по API запросам

## Базовый URL `/api/`

## Аутентификация

### Регистрация нового пользователя
**Endpoint:** `POST /auth/sign-up`

**Доступ:** Все пользователи

**Описание:** Создает нового пользователя в системе и возвращает токен для аутентификации.

**Тело запроса (JSON):**
```json
{
  "username": "string",
  "first_name": "string",
  "last_name": "string",
  "password": "string",
  "property_type": "string",  
  "address": "string",       
  "phone": "string"           
}
```

**Поля:**
- `username` (обязательный) - имя пользователя (логин)
- `first_name` (обязательный) - имя
- `last_name` (обязательный) - фамилия
- `password` (обязательный) - пароль
- `property_type` (опциональный) - тип собственности
- `address` (опциональный) - адрес
- `phone` (опциональный) - телефон

**Успешный ответ (201 Created):**
```json
{
  "user_id": "string",
  "token": "string"
}
```

**Ошибки:**
- 400 Bad Request - неверный формат запроса
- 500 Internal Server Error - внутренняя ошибка сервера

---

### Вход в систему
**Endpoint:** `POST /auth/sign-in`

**Доступ:** Все пользователи

**Описание:** Аутентифицирует пользователя и возвращает токен для работы с API.

**Тело запроса (JSON):**
```json
{
  "username": "string",
  "password": "string"
}
```

**Поля:**
- `username` (обязательный) - имя пользователя (логин)
- `password` (обязательный) - пароль

**Успешный ответ (200 OK):**
```json
{
  "user_id": "string",
  "token": "string"
}
```

**Ошибки:**
- 400 Bad Request - неверный формат запроса
- 500 Internal Server Error - внутренняя ошибка сервера

---

## Профиль пользователя [Работает]

### Получение информации о текущем пользователе
**Endpoint:** `GET /me`

**Доступ:** Только аутентифицированные пользователи

**Описание:** Возвращает информацию о текущем аутентифицированном пользователе.

**Заголовки:**
- `Authorization: Bearer <token>`

**Успешный ответ (200 OK):**
```json
{
  "id": "string",
  "username": "string",
  "first_name": "string", 
  "role": "string",
  "property_type": "string",
  "address": "string",
  "phone": "string"
}
```

**Ошибки:**
- 401 Unauthorized - отсутствует или неверный токен аутентификации
- 500 Internal Server Error - внутренняя ошибка сервера

---

### Обновление профиля пользователя
**Endpoint:** `PUT /me` 

**Доступ:** Только аутентифицированные пользователи

**Примечание:** В текущей реализации не завершено

---

## Работа с пользователями (для администраторов и сотрудников)

### Получение списка пользователей
**Endpoint:** `GET /users/`

**Доступ:** Администраторы и сотрудники

**Примечание:** В текущей реализации не завершено

---

### Получение информации о пользователе по ID
**Endpoint:** `GET /users/:id`

**Доступ:** Администраторы и сотрудники

**Описание:** Возвращает информацию о пользователе с указанным ID.

**Параметры URL:**
- `id` - идентификатор пользователя

**Заголовки:**
- `Authorization: Bearer <token>`

**Успешный ответ (200 OK):**
```json
{
  "id": "string",
  "username": "string",
  "first_name": "string",
  "last_name": "string", 
  "role" : "string",
  "property_type": "string",
  "address": "string",
  "phone": "string"
}
```

**Ошибки:**
- 401 Unauthorized - отсутствует или неверный токен аутентификации
- 403 Forbidden - недостаточно прав для выполнения операции
- 404 Not Found - пользователь не найден
- 500 Internal Server Error - внутренняя ошибка сервера

# Минибанк: Сервис пользователей (User Service)

## Статус реализации
### Уровень Handler
| Метод           | Статус       | Комментарии                       |
|-----------------|--------------|-----------------------------------|
| `GetMe`         | ✅ Реализован |                                   |
| `SignUp`        | ⚠ Частично   | Нет обработки подтверждения email |
| `SignIn`        | ✅ Реализован |                                   |
| `UpdateProfile` | ✅ Реализован |                                   |
| `GetUserByID`   | ✅ Реализован |                                   |
| `GetUsers`      | ✅ Реализован |                                   |

### Уровень Service (`UserService`)
| Метод            | Статус       | Комментарии                                  |
|------------------|--------------|----------------------------------------------|
| `GetUserByID`    | ✅ Реализован |                                              |
| `GetUsers`       | ✅ Реализован |                                              |
| `UpdateUserByID` | ✅ Реализован |                                              |
| `SignUp`         | ⚠ Частично   | Нет валидации email и отправки подтверждения |
| `SignIn`         | ⚠ Частично   | Нет проверки подтверждения email             |

### Уровень Storage (`UserStorage`)
| Метод                    | Статус       | Комментарии |
|--------------------------|--------------|-------------|
| `GetUserByID`            | ✅ Реализован |             |
| `GetUsers`               | ✅ Реализован |             |
| `CreateUser`             | ✅ Реализован |             |
| `GetUserIDByCredentials` | ✅ Реализован |             |



___

# Административный сервис (Admin Service)

## Статус реализации

### Уровень Handler
| Метод             | Статус       | Комментарии                        |
|-------------------|--------------|------------------------------------|
| `GetEmployees`    | ✅ Реализован | Полная реализация с проверкой прав |
| `PaySalary`       | ✅ Реализован | Полная реализация с валидацией     |
| `GetEmployeeByID` | ✅ Реализован | Полная реализация с проверкой прав |

### Уровень Service 
| Метод          | Статус         | Комментарии |
|----------------|----------------|-------------|
| `GetEmployees` | ✅ Реализован   |             |
| `PaySalary`    | ✅ Реализован   |             |
| `GetEmployee`  | ✅ Реализован   |             |

### Уровень Storage 
| Метод                 | Статус          | Комментарии                     |
|-----------------------|-----------------|---------------------------------|
| `GetEmployees`        | ✅ Реализован    |                                 |
| `GetEmployeeByID`     | ✅ Реализован    |                                 |
| `CreateSalaryPayment` | ❌ Не реализован | Требуются транзакции + проверки |
| `GetSalaryPayments`   | ❌ Не реализован | Нужна пагинация + фильтрация    |

## Приоритетные задачи

1. **Реализация сервисного слоя**:
    - Логика выплаты зарплаты (`PaySalary`)

2. **Реализация хранилища**:
    - `SalaryPaymentRepository` для учета выплат
    - Транзакционная логика для финансовых операций

3. **Дополнительная функциональность**:
    - История выплат с фильтрацией и пагинацией
    - Статистика по выплатам (отчеты)

4. **Безопасность**:
    - Логирование всех критических операций

___
